<div class="checkout">
  <h2>Subtotal: <%= @order.subtotal %></h2>
  <% if @coupom %>
    <h3>Valor de desconto: <%= @coupom.value %></h3>
  <% end %>

  <%= form_tag("/checkouts/new", method: "get") do %>
    <%= hidden_field_tag :order_id, @order.id %>
    <%= label_tag(:coupom_code, "Código do cupom") %>
    <%= text_field_tag(:coupom_code) %>
    <%= submit_tag("Aplicar cupom") %>
  <% end %>

  <%= form_for @checkout do |f| %>
    <%= hidden_field_tag(:order_id, @order.id) %>

    <% if @coupom %>
      <%= hidden_field_tag(:coupom_code, @coupom.code) %>
    <% end %>

    <hr>

    <div class="form-group">
      <div class="row">
        <div class="col">
          <%= f.label :first_name, 'Primeiro nome' %>
          <%= f.text_field :first_name, class: 'form-control', input_html: {value: current_user ? current_user.first_name : "" } %>
        </div>

        <div class="col">
          <%= f.label :last_name, 'Sobrenome' %>
          <%= f.text_field :last_name, class: 'form-control', input_html: {value: current_user ? current_user.last_name : "" } %>
        </div>
      </div>
    </div>

    <div class="form-group">
      <div class="row">
        <div class="col">
          <%= f.label :email, 'Email para contato' %>
          <%= f.text_field :email, class: 'form-control', input_html: {value: current_user ? current_user.email : "" } %>
        </div>

        <div class="col">
          <%= f.label :phone, 'Telefone para contato' %>
          <%= f.text_field :phone, class: 'form-control', input_html: {value: current_user ? current_user.phone : "" } %>
        </div>
      </div>
    </div>

    <hr>

    <hr>

    <h2>Endereço de entrega</h2>

    <div class="form-group">
      <div class="row">
        <div class="col">
          <%= f.label :shipping_address, 'Endereço' %>
          <%= f.text_field :shipping_address, class: 'form-control', input_html: { value: @shipping_address ? @shipping_address.street : "" } %>
        </div>

        <div class="col">
          <%= f.label :shipping_suburb, 'Cidade' %>
          <%= f.text_field :shipping_suburb, class: 'form-control', input_html: { value: @shipping_address ? @shipping_address.city : "" } %>
        </div>
      </div>
    </div>

    <div class="form-group">
      <div class="row">
        <div class="col">
          <%= f.label :shipping_zip, 'CEP' %>
          <%= f.text_field :shipping_zip, class: 'form-control', input_html: { value: @shipping_address ? @shipping_address.zip_code : "" } %>
        </div>

        <div class="col">
          <%= f.label :shipping_state, 'Estado' %>
          <%= f.text_field :shipping_state, class: 'form-control', input_html: { value: @shipping_address ? @shipping_address.state : "" } %>
        </div>
      </div>
    </div>

    <hr>

    <div class="form-group">
      <div class="row">
        <div class="col">
          <%= f.label :credit_card_number, 'Número do cartão' %>
          <%= f.text_field :credit_card_number, class: 'form-control', input_html: { value: @credit_card ? @credit_card.number : "" } %>
        </div>

        <div class="col">
          <%= f.label :credit_card_name, 'Nome (como escrito no cartão)' %>
          <%= f.text_field :credit_card_name, class: 'form-control', input_html: { value: @credit_card ? @credit_card.name : "" } %>
        </div>
      </div>
    </div>

    <div class="form-group">
      <div class="row">
        <div class="col">
          <%= f.label :credit_card_expire_date, 'Validade' %>
          <%= f.text_field :credit_card_expire_date, class: 'form-control', input_html: { value: @credit_card ? @shipping_address.zip_code : "" } %>
        </div>

        <div class="col">
          <%= f.label :shipping_state, 'Estado' %>
          <%= f.text_field :shipping_state, class: 'form-control', input_html: { value: @shipping_address ? @shipping_address.state : "" } %>
        </div>
      </div>
    </div>

    <div class="checkout-section checkout-payment">
      <h2>Payment method</h2>

      <%= f.input :credit_card_number, input_html: {value: current_user ? current_user.credit_card_number : "" } %>
      <%= f.input :credit_card_name, input_html: {value: current_user ? current_user.credit_card_name : "" } %>
      <%= f.input :credit_card_expire_date, input_html: {value: current_user ? current_user.credit_card_expire_date : "" } %>
      <%= f.input :credit_card_ccv, input_html: {value: current_user ? current_user.credit_card_ccv : "" } %>

      <%= f.submit "Complete Purchase" %>
    </div>
  <% end %>
</div>